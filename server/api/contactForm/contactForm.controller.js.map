{"version":3,"sources":["api/contactForm/contactForm.controller.js"],"names":["create","app","extend","from","host","secureConnection","port","transportMethod","auth","user","process","env","GOOGLE_ID","pass","GOOGLE_SECRET","set","__dirname","handleSendEmail","req","res","mailer","send","template","bcc","to","body","Email","subject","message","Mensagem","err","console","log","then"],"mappings":"AAAA;;;;;;AAMA;;;;;QA8CgBA,M,GAAAA,M;;AA7ChB;;;;AACA;;;;AACA;;;;;;AAEA,IAAIC,MAAM,wBAAV;;AAEA;;AAEA,wBAAOC,MAAP,CAAcD,GAAd,EAAmB;AACjBE,QAAM,oBADW;AAEjBC,QAAM,gBAFW,EAEO;AACxBC,oBAAkB,IAHD,EAGO;AACxBC,QAAM,GAJW,EAIN;AACXC,mBAAiB,MALA,EAKQ;AACzBC,QAAM;AACJC,UAAMC,QAAQC,GAAR,CAAYC,SADd;AAEJC,UAAMH,QAAQC,GAAR,CAAYG;AAFd;AANW,CAAnB;;AAYAb,IAAIc,GAAJ,CAAQ,OAAR,EAAoBC,SAApB,Q,CAAkC;AAClCf,IAAIc,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;;AAEA,SAASE,eAAT,CAAyBC,GAAzB,EAA8BC,GAA9B,EAAmC;AACjClB,MAAImB,MAAJ,CAAWC,IAAX,CAAgB;AACdC,cAAU,OADI;AAEdC,SAAK;AAFS,GAAhB,EAIE;AACEC,QAAIN,IAAIO,IAAJ,CAASC,KADf;AAEEC,aAAS,4BAFX,EAEyC;AACvCC,aAASV,IAAIO,IAAJ,CAASI;AAHpB,GAJF,EAQK,eAAO;AACR,QAAGC,GAAH,EAAQ;AACN;AACAC,cAAQC,GAAR,CAAYF,GAAZ;;AAEAX,UAAIE,IAAJ,CAAS,wCAAT;AACA;AACD;AACDF,QAAIE,IAAJ,CAAS,eAAT;AACD,GAjBH;AAkBD;;AAED;AACO,SAASrB,MAAT,CAAgBkB,GAAhB,EAAqBC,GAArB,EAA0B;AAC/B,SAAO,sBAAYnB,MAAZ,CAAmBkB,IAAIO,IAAvB,EACJQ,IADI,CACChB,gBAAgBC,GAAhB,EAAqBC,GAArB,CADD,CAAP;AAED","file":"contactForm.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n\n * POST    /api/ContactForm              ->  create\n\n */\n'use strict';\nimport ContactForm from './contactForm.model';\nimport express from 'express';\nimport mailer from 'express-mailer';\n\nvar app = express();\n\n// console.log(\"eu funcionei\");\n\nmailer.extend(app, {\n  from: 'doebembr@gmail.com',\n  host: 'smtp.gmail.com', // hostname\n  secureConnection: true, // use SSL\n  port: 465, // port for secure SMTP\n  transportMethod: 'SMTP', // default is SMTP. Accepts anything that nodemailer accepts\n  auth: {\n    user: process.env.GOOGLE_ID,\n    pass: process.env.GOOGLE_SECRET\n  }\n});\n\napp.set('views', `${__dirname}/`);//path.resolve( __dirname, '/'));\napp.set('view engine', 'pug');\n\nfunction handleSendEmail(req, res) {\n  app.mailer.send({\n    template: 'email',\n    bcc: 'doebembr@gmail.com'\n  },\n    {\n      to: req.body.Email,\n      subject: 'Sua mensagem para a doebem', // REQUIRED.\n      message: req.body.Mensagem\n    }, err => {\n      if(err) {\n        // handle error\n        console.log(err);\n\n        res.send('Ocorreu um erro ao enviar sua mensagem');\n        return;\n      }\n      res.send('Email enviado');\n    });\n}\n\n// Creates a new ContactForm in the DB\nexport function create(req, res) {\n  return ContactForm.create(req.body)\n    .then(handleSendEmail(req, res));\n}\n"]}