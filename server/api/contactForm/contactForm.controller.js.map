{"version":3,"sources":["api/contactForm/contactForm.controller.js"],"names":["create","app","extend","from","host","secureConnection","port","transportMethod","auth","user","process","env","GMAIL_USER","pass","GMAIL_SECRET","set","__dirname","handleSendEmail","res","console","log","mailer","send","template","bcc","to","email","subject","message","err","req","body","then"],"mappings":"AAAA;;;;;;AAMA;;;;;QA4CgBA,M,GAAAA,M;;AA3ChB;;;;AACA;;;;AACA;;;;;;AAEA,IAAIC,MAAM,wBAAV;;AAEA,wBAAOC,MAAP,CAAcD,GAAd,EAAmB;AACjBE,QAAM,6CADW;AAEjBC,QAAM,gBAFW,EAEO;AACxBC,oBAAkB,IAHD,EAGO;AACxBC,QAAM,GAJW,EAIN;AACXC,mBAAiB,MALA,EAKQ;AACzBC,QAAM;AACJC,UAAMC,QAAQC,GAAR,CAAYC,UADd;AAEJC,UAAMH,QAAQC,GAAR,CAAYG;AAFd;AANW,CAAnB;;AAYAb,IAAIc,GAAJ,CAAQ,OAAR,EAAoBC,SAApB,Q,CAAkC;AAClCf,IAAIc,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;;AAEA,SAASE,eAAT,CAAyBC,GAAzB,EAA8B;AAC5BC,UAAQC,GAAR,CAAY,MAAZ,EAAoBJ,SAApB;AACAf,MAAIoB,MAAJ,CAAWC,IAAX,CAAgB;AACdC,cAAU,OADI;AAEdC,SAAK;AAFS,GAAhB,EAIE;AACEC,QAAIP,IAAIQ,KADV;AAEEC,aAAS,4BAFX,EAEyC;AACvCC,aAASV,IAAIU;AAHf,GAJF,EAQK,eAAO;AACR,QAAGC,GAAH,EAAQ;AACN;AACAV,cAAQC,GAAR,CAAYS,GAAZ;AACAX,UAAII,IAAJ,CAAS,sCAAT;AACA;AACD;AACDJ,QAAII,IAAJ,CAAS,YAAT;AACD,GAhBH;AAiBD;;AAED;AACO,SAAStB,MAAT,CAAgB8B,GAAhB,EAAqBZ,GAArB,EAA0B;AAC/B,SAAO,sBAAYlB,MAAZ,CAAmB8B,IAAIC,IAAvB,EACJC,IADI,CACCf,gBAAgBC,GAAhB,CADD,CAAP;AAED","file":"contactForm.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n\n * POST    /api/ContactForm              ->  create\n\n */\n'use strict';\nimport ContactForm from './contactForm.model';\nimport express from 'express';\nimport mailer from 'express-mailer';\n\nvar app = express();\n\nmailer.extend(app, {\n  from: 'Jean Philip de Rogatis <jrogatis@gmail.com>',\n  host: 'smtp.gmail.com', // hostname\n  secureConnection: true, // use SSL\n  port: 465, // port for secure SMTP\n  transportMethod: 'SMTP', // default is SMTP. Accepts anything that nodemailer accepts\n  auth: {\n    user: process.env.GMAIL_USER,\n    pass: process.env.GMAIL_SECRET\n  }\n});\n\napp.set('views', `${__dirname}/`);//path.resolve( __dirname, '/'));\napp.set('view engine', 'pug');\n\nfunction handleSendEmail(res) {\n  console.log('path', __dirname);\n  app.mailer.send({\n    template: 'email',\n    bcc: 'jrogatis@metaconexao.com.br'\n  },\n    {\n      to: res.email,\n      subject: 'Sua mensagem para a doebem', // REQUIRED.\n      message: res.message\n    }, err => {\n      if(err) {\n        // handle error\n        console.log(err);\n        res.send('There was an error sending the email');\n        return;\n      }\n      res.send('Email Sent');\n    });\n}\n\n// Creates a new ContactForm in the DB\nexport function create(req, res) {\n  return ContactForm.create(req.body)\n    .then(handleSendEmail(res));\n}\n"]}